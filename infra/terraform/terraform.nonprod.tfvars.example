project_name       = "ai-pr-reviewer"
environment        = "nonprod"
log_retention_days = 14

# AWS region (default: us-gov-west-1 for GovCloud)
# aws_region = "us-gov-west-1"

# Optional explicit allow-list. Empty list means allow all repos where app is installed.
github_allowed_repos = [
  # "my-org/my-repo"
]

# Bedrock config
bedrock_agent_id       = ""
bedrock_agent_alias_id = ""
bedrock_model_id       = "anthropic.claude-3-5-sonnet-20240620-v1:0"  # GovCloud FedRAMP/IL4/5 authorized
bedrock_guardrail_id      = ""
bedrock_guardrail_version = ""
bedrock_guardrail_trace   = "DISABLED"

# Keep safe during first non-prod rollout.
dry_run = true

# Autonomous remediation PR mode (start disabled until review confidence is high)
auto_pr_enabled       = false
auto_pr_max_files     = 5
auto_pr_branch_prefix = "ai-autofix"
review_comment_mode   = "inline_best_effort"

# Jira/Confluence chatbot service
chatbot_enabled         = true
chatbot_model_id        = "anthropic.claude-3-5-sonnet-20240620-v1:0"  # GovCloud FedRAMP/IL4/5 authorized
chatbot_guardrail_id    = ""
chatbot_guardrail_version = ""
chatbot_guardrail_trace = "disabled"

# Bedrock Guardrails (Terraform-managed)
create_bedrock_guardrail_resources = false
create_chatbot_guardrail_resources = false

chatbot_retrieval_mode  = "hybrid"
chatbot_default_assistant_mode = "contextual"
chatbot_llm_provider    = "bedrock"
chatbot_allowed_llm_providers = ["bedrock"]
chatbot_allowed_model_ids = [
  "anthropic.claude-3-7-sonnet-20250219-v1:0",
  # "amazon.nova-lite-v1:0",
  # "amazon.nova-pro-v1:0",
]
chatbot_github_live_enabled = false
chatbot_github_live_repos = ["my-org/my-repo"]
chatbot_github_live_max_results = 2
chatbot_memory_enabled = true
chatbot_atlassian_user_auth_enabled = false
chatbot_atlassian_session_broker_enabled = false
chatbot_atlassian_session_ttl_seconds = 3600
chatbot_memory_max_turns = 4
chatbot_memory_ttl_days = 30
chatbot_memory_compaction_chars = 12000
chatbot_user_requests_per_minute = 120
chatbot_conversation_requests_per_minute = 60
chatbot_quota_fail_open = false
chatbot_response_cache_enabled = true
chatbot_response_cache_table = ""
chatbot_response_cache_ttl_seconds = 1200
chatbot_response_cache_min_query_length = 12
chatbot_response_cache_max_answer_chars = 16000
chatbot_response_cache_lock_ttl_seconds = 15
chatbot_response_cache_lock_wait_ms = 150
chatbot_response_cache_lock_wait_attempts = 6
chatbot_rerank_enabled = true
chatbot_rerank_top_k_per_source = 3
chatbot_prompt_safety_enabled = true
chatbot_context_safety_block_request = false
chatbot_safety_scan_char_limit = 8000
chatbot_context_max_chars_per_source = 2500
chatbot_context_max_total_chars = 8000
chatbot_budgets_enabled = true
chatbot_budget_table = ""
chatbot_budget_soft_limit_usd = 0.25
chatbot_budget_hard_limit_usd = 0.75
chatbot_budget_ttl_days = 90
chatbot_jira_max_results = 3
chatbot_confluence_max_results = 3
chatbot_router_low_cost_bedrock_model_id = "amazon.nova-lite-v1:0"
chatbot_router_high_quality_bedrock_model_id = ""
chatbot_model_pricing_json = "{}"
worker_lambda_architecture = "arm64"
worker_lambda_memory_size = 768
chatbot_lambda_architecture = "arm64"
chatbot_lambda_memory_size = 384
chatbot_image_model_id = "amazon.nova-canvas-v1:0"
chatbot_image_enabled = false
chatbot_image_default_size = "1024x1024"
chatbot_image_safety_enabled = true
chatbot_image_banned_terms = ["explicit sexual", "nudity", "child sexual", "self-harm", "graphic gore", "extreme violence", "dismemberment"]
chatbot_image_user_requests_per_minute = 6
chatbot_image_conversation_requests_per_minute = 3
chatbot_observability_enabled = true
chatbot_metrics_namespace = ""
chatbot_websocket_enabled = true
chatbot_websocket_stage = "prod"
chatbot_websocket_default_chunk_chars = 120
bedrock_knowledge_base_id = "<SET_KB_ID>"
bedrock_kb_top_k        = 3

# Optional managed Bedrock KB creation (advanced)
# Set create_bedrock_kb_resources=true to let Terraform manage KB resources.
create_bedrock_kb_resources = false
create_managed_bedrock_kb_role = false
managed_bedrock_kb_role_arn = ""
managed_bedrock_kb_role_name = "bedrock-kb-service-role"
create_managed_bedrock_kb_opensearch_collection = false
managed_bedrock_kb_opensearch_collection_name = "bedrock-kb"
managed_bedrock_kb_opensearch_allow_public = false
managed_bedrock_kb_opensearch_collection_arn = ""
managed_bedrock_kb_opensearch_vector_index_name = "bedrock-kb-default-index"
managed_bedrock_kb_embedding_model_arn = "arn:aws-us-gov:bedrock:us-gov-west-1::foundation-model/amazon.titan-embed-text-v2:0"
managed_bedrock_kb_vector_field = "bedrock-knowledge-base-default-vector"
managed_bedrock_kb_text_field = "AMAZON_BEDROCK_TEXT_CHUNK"
managed_bedrock_kb_metadata_field = "AMAZON_BEDROCK_METADATA"
managed_bedrock_kb_data_source_name = "primary-s3"

# Scheduled Confluence -> Bedrock Knowledge Base sync
kb_sync_enabled            = true
bedrock_kb_data_source_id  = "<SET_KB_DATA_SOURCE_ID>"
kb_sync_schedule_expression = "rate(6 hours)"
kb_sync_s3_prefix          = "confluence"
confluence_sync_cql        = "type=page order by lastmodified desc"
confluence_sync_limit      = 25

# Scheduled GitHub docs -> Bedrock Knowledge Base sync
github_kb_sync_enabled              = false
github_kb_data_source_id            = ""
github_kb_sync_schedule_expression  = "rate(6 hours)"
github_kb_sync_s3_prefix            = "github"
github_kb_repos                     = ["my-org/my-repo"]
github_kb_include_patterns          = ["README.md", "docs/**", "**/*.md"]
github_kb_max_files_per_repo        = 200

# Teams adapter endpoint (enable only when testing Teams integration)
teams_adapter_enabled = false
teams_adapter_token   = ""

# Secrets Manager mode
create_secrets_manager_secrets = false
existing_github_webhook_secret_arn         = "arn:aws-us-gov:secretsmanager:us-gov-west-1:123456789012:secret:ai-pr-reviewer/nonprod/github_webhook_secret"
existing_github_app_private_key_secret_arn = "arn:aws-us-gov:secretsmanager:us-gov-west-1:123456789012:secret:ai-pr-reviewer/nonprod/github_app_private_key_pem"
existing_github_app_ids_secret_arn         = "arn:aws-us-gov:secretsmanager:us-gov-west-1:123456789012:secret:ai-pr-reviewer/nonprod/github_app_ids"
existing_atlassian_credentials_secret_arn  = "arn:aws-us-gov:secretsmanager:us-gov-west-1:123456789012:secret:ai-pr-reviewer/nonprod/atlassian_credentials"
existing_chatbot_api_token_secret_arn      = "arn:aws-us-gov:secretsmanager:us-gov-west-1:123456789012:secret:ai-pr-reviewer/nonprod/chatbot_api_token"
existing_teams_adapter_token_secret_arn    = "" # required when teams_adapter_enabled=true

# Chatbot route login/auth mode:
# - token       => existing X-Api-Token / X-Teams-Adapter-Token checks inside Lambda
# - jwt         => API Gateway JWT authorizer (company SSO/OIDC)
# - github_oauth => API Gateway Lambda authorizer validates GitHub OAuth bearer token
chatbot_auth_mode         = "token"
chatbot_jwt_issuer        = ""
chatbot_jwt_audience      = []
github_oauth_allowed_orgs = []
# For GitHub OAuth defaults in EC2 web UI, set these when using chatbot_auth_mode="github_oauth"
# chatbot_auth_mode                    = "github_oauth"
# github_oauth_allowed_orgs            = ["my-org"]
# webapp_default_auth_mode             = "bearer"
# webapp_default_github_oauth_base_url = "https://github.my-company.mil"
# webapp_default_github_client_id      = "Iv1.0123456789abcdef"
# webapp_default_github_scope          = "read:user read:org"

# Optional S3-hosted static chatbot web UI
webapp_hosting_enabled = false
webapp_hosting_mode    = "s3"
webapp_bucket_name     = ""

# Optional fixed-IP static chatbot web UI (ec2_eip mode)
# webapp_hosting_mode         = "ec2_eip"
# webapp_private_only         = true
# webapp_ec2_subnet_id        = "subnet-xxxxxxxx"
# webapp_ec2_instance_type    = "t3.micro"
# webapp_ec2_allowed_cidrs    = ["203.0.113.10/32"]
# webapp_ec2_key_name         = "my-keypair"
# webapp_ec2_ami_id           = "" # optional override
# webapp_tls_enabled          = true
# webapp_tls_acm_certificate_arn = "arn:aws-us-gov:acm:us-gov-west-1:123456789012:certificate/xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx"
# webapp_tls_subnet_ids       = ["subnet-aaaaaaa", "subnet-bbbbbbb"]
# webapp_default_chatbot_url  = "https://<api-id>.execute-api.us-gov-west-1.amazonaws.com/chatbot/query"
